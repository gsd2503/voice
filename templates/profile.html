{% extends "base.html" %}

{% block content %}
<!-- Mobile Header -->
<div class="mobile-header">
    <h1><i class="fas fa-city"></i> Voice</h1>
    <div class="user-info">
        <span>ðŸ‘¤ {{ current_user.full_name }}</span>
        <span style="font-size: 0.8rem; opacity: 0.9;">({{ USER_ROLES[current_user.role] }})</span>
    </div>
</div>

<!-- Navigation Tabs -->
<div class="mobile-tabs">
    <a href="{{ url_for('dashboard') }}" class="mobile-tab">Home</a>
    <a href="{{ url_for('report_issue') }}" class="mobile-tab">Report Issue</a>
    <a href="{{ url_for('my_issues') }}" class="mobile-tab">My Issues</a>
    <a href="{{ url_for('map_view') }}" class="mobile-tab">Map</a>
    <a href="{{ url_for('profile') }}" class="mobile-tab active">Profile</a>
    <a href="{{ url_for('logout') }}" class="mobile-tab">Logout</a>
</div>

<!-- Profile Header -->
<div class="mobile-card">
    <div class="row">
        <div class="col-md-4 text-center">
            <div style="font-size: 5rem; margin-bottom: 1rem;">
                {% if current_user.role == 'admin' %}ðŸ‘‘{% else %}ðŸ‘¤{% endif %}
            </div>
            <div style="font-size: 1.2rem; font-weight: bold;">
                {{ current_user.full_name }}
            </div>
            <div style="color: #667eea; margin-top: 0.5rem;">
                {{ USER_ROLES[current_user.role] }}
            </div>
        </div>
        <div class="col-md-8">
            <h3><i class="fas fa-user"></i> Profile Information</h3>
            <div class="row mt-3">
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-control" value="{{ current_user.username }}" readonly>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="text" class="form-control" value="{{ current_user.email }}" readonly>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" value="{{ current_user.full_name }}" readonly>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">Phone</label>
                        <input type="text" class="form-control"
                               value="{{ current_user.phone if current_user.phone else 'Not provided' }}" readonly>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">Member Since</label>
                        <input type="text" class="form-control"
                               value="{{ current_user.created_at.strftime('%Y-%m-%d') }}" readonly>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">Last Login</label>
                        <input type="text" class="form-control"
                               value="{{ current_user.last_login.strftime('%Y-%m-%d %H:%M') if current_user.last_login else 'Never' }}" readonly>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- My Statistics -->
<div class="mobile-card">
    <h3><i class="fas fa-chart-bar"></i> My Statistics</h3>
    <div class="row mt-3">
        <div class="col-md-4 mb-3">
            <div class="admin-stat-card">
                <div class="admin-stat-value">{{ user_stats.total_issues }}</div>
                <div class="admin-stat-label">Total Issues</div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="admin-stat-card">
                <div class="admin-stat-value">{{ user_stats.pending_issues }}</div>
                <div class="admin-stat-label">Pending Issues</div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="admin-stat-card">
                <div class="admin-stat-value">{{ user_stats.resolved_issues }}</div>
                <div class="admin-stat-label">Resolved Issues</div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Activity -->
<div class="mobile-card">
    <h3><i class="fas fa-history"></i> Recent Activity</h3>
    <div class="mt-3">
        <ul class="list-group">
            <li class="list-group-item">
                <i class="fas fa-user-plus text-success"></i>
                Joined Voice on {{ current_user.created_at.strftime('%B %d, %Y') }}
            </li>
            {% if current_user.last_login %}
            <li class="list-group-item">
                <i class="fas fa-sign-in-alt text-primary"></i>
                Last login on {{ current_user.last_login.strftime('%B %d, %Y at %H:%M') }}
            </li>
            {% endif %}
            <li class="list-group-item">
                <i class="fas fa-flag text-info"></i>
                Reported {{ user_stats.total_issues }} issue(s) in total
            </li>
            <li class="list-group-item">
                <i class="fas fa-check-circle text-success"></i>
                {{ user_stats.resolved_issues }} issue(s) resolved
            </li>
        </ul>
    </div>
</div>

<!-- Action Buttons -->
<div class="mobile-card">
    <h3><i class="fas fa-cogs"></i> Account Actions</h3>
    <div class="row mt-3">
        <div class="col-md-6 mb-2">
            <a href="{{ url_for('dashboard') }}" class="btn btn-outline-primary w-100">
                <i class="fas fa-home"></i> Go to Dashboard
            </a>
        </div>
        <div class="col-md-6 mb-2">
            <button class="btn btn-outline-secondary w-100" onclick="editProfile()">
                <i class="fas fa-edit"></i> Edit Profile
            </button>
        </div>
        <div class="col-md-6 mb-2">
            <button class="btn btn-outline-info w-100" onclick="changePassword()">
                <i class="fas fa-key"></i> Change Password
            </button>
        </div>
        <div class="col-md-6 mb-2">
            <a href="{{ url_for('logout') }}" class="btn btn-outline-danger w-100">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
        </div>
    </div>
</div>

<!-- Account Status -->
<div class="mobile-card">
    <h3><i class="fas fa-shield-alt"></i> Account Status</h3>
    <div class="mt-3">
        <div class="alert alert-success">
            <i class="fas fa-check-circle"></i>
            <strong>Account Status:</strong> Active
            <span class="float-end">
                <i class="fas fa-badge-check text-success"></i> Verified
            </span>
        </div>
        <p class="text-muted">
            <small>
                <i class="fas fa-info-circle"></i>
                Your account is in good standing. You can report issues, upvote, and comment on other reports.
            </small>
        </p>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function editProfile() {
    // In a real implementation, this would show an edit modal
    alert('Edit profile functionality would be implemented here');
    // This could open a modal or redirect to an edit page
}

function changePassword() {
    // In a real implementation, this would show a change password modal
    alert('Change password functionality would be implemented here');
    // This could open a modal with password change form
}
</script>
{% endblock %}